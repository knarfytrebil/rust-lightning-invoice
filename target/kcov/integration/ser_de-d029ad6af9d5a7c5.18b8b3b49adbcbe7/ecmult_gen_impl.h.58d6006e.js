var data = {lines:[
{"lineNum":"    1","line":"/**********************************************************************"},
{"lineNum":"    2","line":" * Copyright (c) 2013, 2014, 2015 Pieter Wuille, Gregory Maxwell      *"},
{"lineNum":"    3","line":" * Distributed under the MIT software license, see the accompanying   *"},
{"lineNum":"    4","line":" * file COPYING or http://www.opensource.org/licenses/mit-license.php.*"},
{"lineNum":"    5","line":" **********************************************************************/"},
{"lineNum":"    6","line":""},
{"lineNum":"    7","line":"#ifndef SECP256K1_ECMULT_GEN_IMPL_H"},
{"lineNum":"    8","line":"#define SECP256K1_ECMULT_GEN_IMPL_H"},
{"lineNum":"    9","line":""},
{"lineNum":"   10","line":"#include \"util.h\""},
{"lineNum":"   11","line":"#include \"scalar.h\""},
{"lineNum":"   12","line":"#include \"group.h\""},
{"lineNum":"   13","line":"#include \"ecmult_gen.h\""},
{"lineNum":"   14","line":"#include \"hash_impl.h\""},
{"lineNum":"   15","line":"#ifdef USE_ECMULT_STATIC_PRECOMPUTATION"},
{"lineNum":"   16","line":"#include \"ecmult_static_context.h\""},
{"lineNum":"   17","line":"#endif"},
{"lineNum":"   18","line":""},
{"lineNum":"   19","line":"#ifndef USE_ECMULT_STATIC_PRECOMPUTATION"},
{"lineNum":"   20","line":"    static const size_t SECP256K1_ECMULT_GEN_CONTEXT_PREALLOCATED_SIZE = ROUND_TO_ALIGN(sizeof(*((secp256k1_ecmult_gen_context*) NULL)->prec));"},
{"lineNum":"   21","line":"#else"},
{"lineNum":"   22","line":"    static const size_t SECP256K1_ECMULT_GEN_CONTEXT_PREALLOCATED_SIZE = 0;"},
{"lineNum":"   23","line":"#endif"},
{"lineNum":"   24","line":""},
{"lineNum":"   25","line":"static void secp256k1_ecmult_gen_context_init(secp256k1_ecmult_gen_context *ctx) {","class":"lineCov","hits":"1","order":"3885","possible_hits":"1",},
{"lineNum":"   26","line":"    ctx->prec = NULL;","class":"lineCov","hits":"1","order":"3886","possible_hits":"1",},
{"lineNum":"   27","line":"}","class":"linePartCov","hits":"1","order":"3887","possible_hits":"2",},
{"lineNum":"   28","line":""},
{"lineNum":"   29","line":"static void secp256k1_ecmult_gen_context_build(secp256k1_ecmult_gen_context *ctx, void **prealloc) {","class":"lineCov","hits":"2","order":"3890","possible_hits":"2",},
{"lineNum":"   30","line":"#ifndef USE_ECMULT_STATIC_PRECOMPUTATION"},
{"lineNum":"   31","line":"    secp256k1_ge prec[1024];"},
{"lineNum":"   32","line":"    secp256k1_gej gj;"},
{"lineNum":"   33","line":"    secp256k1_gej nums_gej;"},
{"lineNum":"   34","line":"    int i, j;"},
{"lineNum":"   35","line":"    size_t const prealloc_size = SECP256K1_ECMULT_GEN_CONTEXT_PREALLOCATED_SIZE;","class":"lineCov","hits":"1","order":"3891","possible_hits":"1",},
{"lineNum":"   36","line":"    void* const base = *prealloc;","class":"lineCov","hits":"1","order":"3892","possible_hits":"1",},
{"lineNum":"   37","line":"#endif"},
{"lineNum":"   38","line":""},
{"lineNum":"   39","line":"    if (ctx->prec != NULL) {","class":"lineCov","hits":"1","order":"3893","possible_hits":"1",},
{"lineNum":"   40","line":"        return;","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"   41","line":"    }"},
{"lineNum":"   42","line":"#ifndef USE_ECMULT_STATIC_PRECOMPUTATION"},
{"lineNum":"   43","line":"    ctx->prec = (secp256k1_ge_storage (*)[64][16])manual_alloc(prealloc, prealloc_size, base, prealloc_size);","class":"lineCov","hits":"1","order":"3894","possible_hits":"1",},
{"lineNum":"   44","line":""},
{"lineNum":"   45","line":"    /* get the generator */"},
{"lineNum":"   46","line":"    secp256k1_gej_set_ge(&gj, &secp256k1_ge_const_g);","class":"lineCov","hits":"1","order":"3895","possible_hits":"1",},
{"lineNum":"   47","line":""},
{"lineNum":"   48","line":"    /* Construct a group element with no known corresponding scalar (nothing up my sleeve). */"},
{"lineNum":"   49","line":"    {"},
{"lineNum":"   50","line":"        static const unsigned char nums_b32[33] = \"The scalar for this x is unknown\";"},
{"lineNum":"   51","line":"        secp256k1_fe nums_x;"},
{"lineNum":"   52","line":"        secp256k1_ge nums_ge;"},
{"lineNum":"   53","line":"        int r;"},
{"lineNum":"   54","line":"        r = secp256k1_fe_set_b32(&nums_x, nums_b32);","class":"lineCov","hits":"1","order":"3906","possible_hits":"1",},
{"lineNum":"   55","line":"        (void)r;"},
{"lineNum":"   56","line":"        VERIFY_CHECK(r);"},
{"lineNum":"   57","line":"        r = secp256k1_ge_set_xo_var(&nums_ge, &nums_x, 0);","class":"lineCov","hits":"1","order":"3945","possible_hits":"1",},
{"lineNum":"   58","line":"        (void)r;"},
{"lineNum":"   59","line":"        VERIFY_CHECK(r);"},
{"lineNum":"   60","line":"        secp256k1_gej_set_ge(&nums_gej, &nums_ge);","class":"lineCov","hits":"1","order":"4150","possible_hits":"1",},
{"lineNum":"   61","line":"        /* Add G to make the bits in x uniformly distributed. */"},
{"lineNum":"   62","line":"        secp256k1_gej_add_ge_var(&nums_gej, &nums_gej, &secp256k1_ge_const_g, NULL);","class":"lineCov","hits":"1","order":"4151","possible_hits":"1",},
{"lineNum":"   63","line":"    }"},
{"lineNum":"   64","line":""},
{"lineNum":"   65","line":"    /* compute prec. */"},
{"lineNum":"   66","line":"    {"},
{"lineNum":"   67","line":"        secp256k1_gej precj[1024]; /* Jacobian versions of prec. */"},
{"lineNum":"   68","line":"        secp256k1_gej gbase;"},
{"lineNum":"   69","line":"        secp256k1_gej numsbase;"},
{"lineNum":"   70","line":"        gbase = gj; /* 16^j * G */","class":"lineCov","hits":"1","order":"4202","possible_hits":"1",},
{"lineNum":"   71","line":"        numsbase = nums_gej; /* 2^j * nums. */","class":"lineCov","hits":"1","order":"4203","possible_hits":"1",},
{"lineNum":"   72","line":"        for (j = 0; j < 64; j++) {","class":"lineCov","hits":"2","order":"4204","possible_hits":"2",},
{"lineNum":"   73","line":"            /* Set precj[j*16 .. j*16+15] to (numsbase, numsbase + gbase, ..., numsbase + 15*gbase). */"},
{"lineNum":"   74","line":"            precj[j*16] = numsbase;","class":"lineCov","hits":"1","order":"4205","possible_hits":"1",},
{"lineNum":"   75","line":"            for (i = 1; i < 16; i++) {","class":"lineCov","hits":"2","order":"4206","possible_hits":"2",},
{"lineNum":"   76","line":"                secp256k1_gej_add_var(&precj[j*16 + i], &precj[j*16 + i - 1], &gbase, NULL);","class":"lineCov","hits":"1","order":"4207","possible_hits":"1",},
{"lineNum":"   77","line":"            }"},
{"lineNum":"   78","line":"            /* Multiply gbase by 16. */"},
{"lineNum":"   79","line":"            for (i = 0; i < 4; i++) {","class":"lineCov","hits":"2","order":"4233","possible_hits":"2",},
{"lineNum":"   80","line":"                secp256k1_gej_double_var(&gbase, &gbase, NULL);","class":"lineCov","hits":"1","order":"4234","possible_hits":"1",},
{"lineNum":"   81","line":"            }"},
{"lineNum":"   82","line":"            /* Multiply numbase by 2. */"},
{"lineNum":"   83","line":"            secp256k1_gej_double_var(&numsbase, &numsbase, NULL);","class":"lineCov","hits":"1","order":"4260","possible_hits":"1",},
{"lineNum":"   84","line":"            if (j == 62) {","class":"lineCov","hits":"1","order":"4261","possible_hits":"1",},
{"lineNum":"   85","line":"                /* In the last iteration, numsbase is (1 - 2^j) * nums instead. */"},
{"lineNum":"   86","line":"                secp256k1_gej_neg(&numsbase, &numsbase);","class":"lineCov","hits":"1","order":"4262","possible_hits":"1",},
{"lineNum":"   87","line":"                secp256k1_gej_add_var(&numsbase, &numsbase, &nums_gej, NULL);","class":"lineCov","hits":"1","order":"4271","possible_hits":"1",},
{"lineNum":"   88","line":"            }"},
{"lineNum":"   89","line":"        }"},
{"lineNum":"   90","line":"        secp256k1_ge_set_all_gej_var(prec, precj, 1024);","class":"lineCov","hits":"1","order":"4272","possible_hits":"1",},
{"lineNum":"   91","line":"    }"},
{"lineNum":"   92","line":"    for (j = 0; j < 64; j++) {","class":"lineCov","hits":"2","order":"4361","possible_hits":"2",},
{"lineNum":"   93","line":"        for (i = 0; i < 16; i++) {","class":"lineCov","hits":"2","order":"4362","possible_hits":"2",},
{"lineNum":"   94","line":"            secp256k1_ge_to_storage(&(*ctx->prec)[j][i], &prec[j*16 + i]);","class":"lineCov","hits":"1","order":"4363","possible_hits":"1",},
{"lineNum":"   95","line":"        }"},
{"lineNum":"   96","line":"    }"},
{"lineNum":"   97","line":"#else"},
{"lineNum":"   98","line":"    (void)prealloc;"},
{"lineNum":"   99","line":"    ctx->prec = (secp256k1_ge_storage (*)[64][16])secp256k1_ecmult_static_context;"},
{"lineNum":"  100","line":"#endif"},
{"lineNum":"  101","line":"    secp256k1_ecmult_gen_blind(ctx, NULL);","class":"lineCov","hits":"1","order":"4396","possible_hits":"1",},
{"lineNum":"  102","line":"}","class":"linePartCov","hits":"1","order":"4770","possible_hits":"2",},
{"lineNum":"  103","line":""},
{"lineNum":"  104","line":"static int secp256k1_ecmult_gen_context_is_built(const secp256k1_ecmult_gen_context* ctx) {"},
{"lineNum":"  105","line":"    return ctx->prec != NULL;"},
{"lineNum":"  106","line":"}"},
{"lineNum":"  107","line":""},
{"lineNum":"  108","line":"static void secp256k1_ecmult_gen_context_finalize_memcpy(secp256k1_ecmult_gen_context *dst, const secp256k1_ecmult_gen_context *src) {"},
{"lineNum":"  109","line":"#ifndef USE_ECMULT_STATIC_PRECOMPUTATION"},
{"lineNum":"  110","line":"    if (src->prec != NULL) {"},
{"lineNum":"  111","line":"        /* We cast to void* first to suppress a -Wcast-align warning. */"},
{"lineNum":"  112","line":"        dst->prec = (secp256k1_ge_storage (*)[64][16])(void*)((unsigned char*)dst + ((unsigned char*)src->prec - (unsigned char*)src));"},
{"lineNum":"  113","line":"    }"},
{"lineNum":"  114","line":"#else"},
{"lineNum":"  115","line":"    (void)dst, (void)src;"},
{"lineNum":"  116","line":"#endif"},
{"lineNum":"  117","line":"}"},
{"lineNum":"  118","line":""},
{"lineNum":"  119","line":"static void secp256k1_ecmult_gen_context_clear(secp256k1_ecmult_gen_context *ctx) {","class":"lineCov","hits":"1","order":"5257","possible_hits":"1",},
{"lineNum":"  120","line":"    secp256k1_scalar_clear(&ctx->blind);","class":"lineCov","hits":"1","order":"5258","possible_hits":"1",},
{"lineNum":"  121","line":"    secp256k1_gej_clear(&ctx->initial);","class":"lineCov","hits":"1","order":"5259","possible_hits":"1",},
{"lineNum":"  122","line":"    ctx->prec = NULL;","class":"lineCov","hits":"1","order":"5260","possible_hits":"1",},
{"lineNum":"  123","line":"}","class":"linePartCov","hits":"1","order":"5261","possible_hits":"2",},
{"lineNum":"  124","line":""},
{"lineNum":"  125","line":"static void secp256k1_ecmult_gen(const secp256k1_ecmult_gen_context *ctx, secp256k1_gej *r, const secp256k1_scalar *gn) {","class":"lineCov","hits":"2","order":"4625","possible_hits":"2",},
{"lineNum":"  126","line":"    secp256k1_ge add;"},
{"lineNum":"  127","line":"    secp256k1_ge_storage adds;"},
{"lineNum":"  128","line":"    secp256k1_scalar gnb;"},
{"lineNum":"  129","line":"    int bits;"},
{"lineNum":"  130","line":"    int i, j;"},
{"lineNum":"  131","line":"    memset(&adds, 0, sizeof(adds));","class":"lineCov","hits":"1","order":"4626","possible_hits":"1",},
{"lineNum":"  132","line":"    *r = ctx->initial;","class":"lineCov","hits":"1","order":"4627","possible_hits":"1",},
{"lineNum":"  133","line":"    /* Blind scalar/point multiplication by computing (n-b)G + bG instead of nG. */"},
{"lineNum":"  134","line":"    secp256k1_scalar_add(&gnb, gn, &ctx->blind);","class":"lineCov","hits":"1","order":"4628","possible_hits":"1",},
{"lineNum":"  135","line":"    add.infinity = 0;","class":"lineCov","hits":"1","order":"4643","possible_hits":"1",},
{"lineNum":"  136","line":"    for (j = 0; j < 64; j++) {","class":"lineCov","hits":"2","order":"4644","possible_hits":"2",},
{"lineNum":"  137","line":"        bits = secp256k1_scalar_get_bits(&gnb, j * 4, 4);","class":"lineCov","hits":"1","order":"4645","possible_hits":"1",},
{"lineNum":"  138","line":"        for (i = 0; i < 16; i++) {","class":"lineCov","hits":"2","order":"4649","possible_hits":"2",},
{"lineNum":"  139","line":"            /** This uses a conditional move to avoid any secret data in array indexes."},
{"lineNum":"  140","line":"             *   _Any_ use of secret indexes has been demonstrated to result in timing"},
{"lineNum":"  141","line":"             *   sidechannels, even when the cache-line access patterns are uniform."},
{"lineNum":"  142","line":"             *  See also:"},
{"lineNum":"  143","line":"             *   \"A word of warning\", CHES 2013 Rump Session, by Daniel J. Bernstein and Peter Schwabe"},
{"lineNum":"  144","line":"             *    (https://cryptojedi.org/peter/data/chesrump-20130822.pdf) and"},
{"lineNum":"  145","line":"             *   \"Cache Attacks and Countermeasures: the Case of AES\", RSA 2006,"},
{"lineNum":"  146","line":"             *    by Dag Arne Osvik, Adi Shamir, and Eran Tromer"},
{"lineNum":"  147","line":"             *    (http://www.tau.ac.il/~tromer/papers/cache.pdf)"},
{"lineNum":"  148","line":"             */"},
{"lineNum":"  149","line":"            secp256k1_ge_storage_cmov(&adds, &(*ctx->prec)[j][i], i == bits);","class":"lineCov","hits":"1","order":"4650","possible_hits":"1",},
{"lineNum":"  150","line":"        }"},
{"lineNum":"  151","line":"        secp256k1_ge_from_storage(&add, &adds);","class":"lineCov","hits":"1","order":"4663","possible_hits":"1",},
{"lineNum":"  152","line":"        secp256k1_gej_add_ge(r, r, &add);","class":"lineCov","hits":"1","order":"4676","possible_hits":"1",},
{"lineNum":"  153","line":"    }"},
{"lineNum":"  154","line":"    bits = 0;","class":"lineCov","hits":"1","order":"4732","possible_hits":"1",},
{"lineNum":"  155","line":"    secp256k1_ge_clear(&add);","class":"lineCov","hits":"1","order":"4733","possible_hits":"1",},
{"lineNum":"  156","line":"    secp256k1_scalar_clear(&gnb);","class":"lineCov","hits":"1","order":"4739","possible_hits":"1",},
{"lineNum":"  157","line":"}","class":"linePartCov","hits":"1","order":"4746","possible_hits":"2",},
{"lineNum":"  158","line":""},
{"lineNum":"  159","line":"/* Setup blinding values for secp256k1_ecmult_gen. */"},
{"lineNum":"  160","line":"static void secp256k1_ecmult_gen_blind(secp256k1_ecmult_gen_context *ctx, const unsigned char *seed32) {","class":"lineCov","hits":"2","order":"4397","possible_hits":"2",},
{"lineNum":"  161","line":"    secp256k1_scalar b;"},
{"lineNum":"  162","line":"    secp256k1_gej gb;"},
{"lineNum":"  163","line":"    secp256k1_fe s;"},
{"lineNum":"  164","line":"    unsigned char nonce32[32];"},
{"lineNum":"  165","line":"    secp256k1_rfc6979_hmac_sha256 rng;"},
{"lineNum":"  166","line":"    int retry;"},
{"lineNum":"  167","line":"    unsigned char keydata[64] = {0};","class":"lineCov","hits":"1","order":"4398","possible_hits":"1",},
{"lineNum":"  168","line":"    if (seed32 == NULL) {","class":"lineCov","hits":"1","order":"4399","possible_hits":"1",},
{"lineNum":"  169","line":"        /* When seed is NULL, reset the initial point and blinding value. */"},
{"lineNum":"  170","line":"        secp256k1_gej_set_ge(&ctx->initial, &secp256k1_ge_const_g);","class":"lineCov","hits":"1","order":"4400","possible_hits":"1",},
{"lineNum":"  171","line":"        secp256k1_gej_neg(&ctx->initial, &ctx->initial);","class":"lineCov","hits":"1","order":"4401","possible_hits":"1",},
{"lineNum":"  172","line":"        secp256k1_scalar_set_int(&ctx->blind, 1);","class":"lineCov","hits":"1","order":"4402","possible_hits":"1",},
{"lineNum":"  173","line":"    }"},
{"lineNum":"  174","line":"    /* The prior blinding value (if not reset) is chained forward by including it in the hash. */"},
{"lineNum":"  175","line":"    secp256k1_scalar_get_b32(nonce32, &ctx->blind);","class":"lineCov","hits":"1","order":"4409","possible_hits":"1",},
{"lineNum":"  176","line":"    /** Using a CSPRNG allows a failure free interface, avoids needing large amounts of random data,"},
{"lineNum":"  177","line":"     *   and guards against weak or adversarial seeds.  This is a simpler and safer interface than"},
{"lineNum":"  178","line":"     *   asking the caller for blinding values directly and expecting them to retry on failure."},
{"lineNum":"  179","line":"     */"},
{"lineNum":"  180","line":"    memcpy(keydata, nonce32, 32);","class":"lineCov","hits":"1","order":"4410","possible_hits":"1",},
{"lineNum":"  181","line":"    if (seed32 != NULL) {","class":"lineCov","hits":"1","order":"4411","possible_hits":"1",},
{"lineNum":"  182","line":"        memcpy(keydata + 32, seed32, 32);","class":"lineNoCov","hits":"0","possible_hits":"1",},
{"lineNum":"  183","line":"    }"},
{"lineNum":"  184","line":"    secp256k1_rfc6979_hmac_sha256_initialize(&rng, keydata, seed32 ? 64 : 32);","class":"lineCov","hits":"1","order":"4412","possible_hits":"1",},
{"lineNum":"  185","line":"    memset(keydata, 0, sizeof(keydata));","class":"lineCov","hits":"1","order":"4567","possible_hits":"1",},
{"lineNum":"  186","line":"    /* Retry for out of range results to achieve uniformity. */"},
{"lineNum":"  187","line":"    do {"},
{"lineNum":"  188","line":"        secp256k1_rfc6979_hmac_sha256_generate(&rng, nonce32, 32);","class":"lineCov","hits":"1","order":"4568","possible_hits":"1",},
{"lineNum":"  189","line":"        retry = !secp256k1_fe_set_b32(&s, nonce32);","class":"lineCov","hits":"1","order":"4582","possible_hits":"1",},
{"lineNum":"  190","line":"        retry |= secp256k1_fe_is_zero(&s);","class":"lineCov","hits":"1","order":"4583","possible_hits":"1",},
{"lineNum":"  191","line":"    } while (retry); /* This branch true is cryptographically unreachable. Requires sha256_hmac output > Fp. */","class":"lineCov","hits":"1","order":"4588","possible_hits":"1",},
{"lineNum":"  192","line":"    /* Randomize the projection to defend against multiplier sidechannels. */"},
{"lineNum":"  193","line":"    secp256k1_gej_rescale(&ctx->initial, &s);","class":"lineCov","hits":"1","order":"4589","possible_hits":"1",},
{"lineNum":"  194","line":"    secp256k1_fe_clear(&s);","class":"lineCov","hits":"1","order":"4598","possible_hits":"1",},
{"lineNum":"  195","line":"    do {"},
{"lineNum":"  196","line":"        secp256k1_rfc6979_hmac_sha256_generate(&rng, nonce32, 32);","class":"lineCov","hits":"1","order":"4603","possible_hits":"1",},
{"lineNum":"  197","line":"        secp256k1_scalar_set_b32(&b, nonce32, &retry);","class":"lineCov","hits":"1","order":"4611","possible_hits":"1",},
{"lineNum":"  198","line":"        /* A blinding value of 0 works, but would undermine the projection hardening. */"},
{"lineNum":"  199","line":"        retry |= secp256k1_scalar_is_zero(&b);","class":"lineCov","hits":"1","order":"4612","possible_hits":"1",},
{"lineNum":"  200","line":"    } while (retry); /* This branch true is cryptographically unreachable. Requires sha256_hmac output > order. */","class":"lineCov","hits":"1","order":"4616","possible_hits":"1",},
{"lineNum":"  201","line":"    secp256k1_rfc6979_hmac_sha256_finalize(&rng);","class":"lineCov","hits":"1","order":"4617","possible_hits":"1",},
{"lineNum":"  202","line":"    memset(nonce32, 0, 32);","class":"lineCov","hits":"1","order":"4623","possible_hits":"1",},
{"lineNum":"  203","line":"    secp256k1_ecmult_gen(ctx, &gb, &b);","class":"lineCov","hits":"1","order":"4624","possible_hits":"1",},
{"lineNum":"  204","line":"    secp256k1_scalar_negate(&b, &b);","class":"lineCov","hits":"1","order":"4747","possible_hits":"1",},
{"lineNum":"  205","line":"    ctx->blind = b;","class":"lineCov","hits":"1","order":"4759","possible_hits":"1",},
{"lineNum":"  206","line":"    ctx->initial = gb;","class":"lineCov","hits":"1","order":"4760","possible_hits":"1",},
{"lineNum":"  207","line":"    secp256k1_scalar_clear(&b);","class":"lineCov","hits":"1","order":"4761","possible_hits":"1",},
{"lineNum":"  208","line":"    secp256k1_gej_clear(&gb);","class":"lineCov","hits":"1","order":"4762","possible_hits":"1",},
{"lineNum":"  209","line":"}","class":"linePartCov","hits":"1","order":"4769","possible_hits":"2",},
{"lineNum":"  210","line":""},
{"lineNum":"  211","line":"#endif /* SECP256K1_ECMULT_GEN_IMPL_H */"},
]};
var percent_low = 25;var percent_high = 75;
var header = { "command" : "ser_de-d029ad6af9d5a7c5", "date" : "2019-08-31 07:54:50", "instrumented" : 83, "covered" : 81,};
var merged_data = [];
